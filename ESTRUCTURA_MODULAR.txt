# ============================================
# ESTRUCTURA MODULAR DEL PROYECTO
# El Mundo Fitness - IaC con Terraform
# ============================================

IAC VALVERDE/
‚îÇ
‚îú‚îÄ‚îÄ üìÑ main.tf                           # Orquestaci√≥n principal (solo m√≥dulos)
‚îú‚îÄ‚îÄ üìÑ variables.tf                      # Variables globales del proyecto
‚îú‚îÄ‚îÄ üìÑ outputs.tf                        # Outputs consolidados
‚îú‚îÄ‚îÄ üìÑ backend.tf                        # Configuraci√≥n backend remoto (S3)
‚îú‚îÄ‚îÄ üìÑ terraform.tfvars.example          # Ejemplo de variables
‚îú‚îÄ‚îÄ üìÑ .gitignore                        # Ignorar archivos sensibles
‚îÇ
‚îú‚îÄ‚îÄ üîß Jenkinsfile                       # Pipeline CI/CD
‚îú‚îÄ‚îÄ üìú deploy.ps1                        # Script PowerShell de despliegue
‚îÇ
‚îú‚îÄ‚îÄ üìñ README.md                         # Documentaci√≥n principal
‚îú‚îÄ‚îÄ üìñ COMANDOS_UTILES.md                # Comandos √∫tiles de Terraform/AWS
‚îú‚îÄ‚îÄ üìñ ARQUITECTURA.txt                  # Diagrama de arquitectura
‚îÇ
‚îú‚îÄ‚îÄ üìÅ modules/                          # M√≥dulos Terraform reutilizables
‚îÇ   ‚îÇ
‚îÇ   ‚îú‚îÄ‚îÄ üìÅ vpc/                         # M√≥dulo de VPC y Networking
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ main.tf                     # VPC, Subnets, IGW, NAT, Endpoints
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ variables.tf                # Variables del m√≥dulo VPC
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ outputs.tf                  # Outputs del m√≥dulo VPC
‚îÇ   ‚îÇ
‚îÇ   ‚îú‚îÄ‚îÄ üìÅ dynamodb/                    # M√≥dulo de DynamoDB
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ main.tf                     # 3 Tablas DynamoDB
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ variables.tf                # Variables del m√≥dulo DynamoDB
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ outputs.tf                  # Outputs del m√≥dulo DynamoDB
‚îÇ   ‚îÇ
‚îÇ   ‚îú‚îÄ‚îÄ üìÅ s3/                          # M√≥dulo de S3
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ main.tf                     # Bucket S3 para frontend
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ variables.tf                # Variables del m√≥dulo S3
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ outputs.tf                  # Outputs del m√≥dulo S3
‚îÇ   ‚îÇ
‚îÇ   ‚îú‚îÄ‚îÄ üìÅ lambda/                      # M√≥dulo de Lambda
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ main.tf                     # 3 Funciones Lambda + IAM + SG
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ variables.tf                # Variables del m√≥dulo Lambda
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ outputs.tf                  # Outputs del m√≥dulo Lambda
‚îÇ   ‚îÇ
‚îÇ   ‚îú‚îÄ‚îÄ üìÅ api-gateway/                 # M√≥dulo de API Gateway
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ main.tf                     # HTTP API + Integraciones
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ variables.tf                # Variables del m√≥dulo API Gateway
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ outputs.tf                  # Outputs del m√≥dulo API Gateway
‚îÇ   ‚îÇ
‚îÇ   ‚îî‚îÄ‚îÄ üìÅ cognito/                     # M√≥dulo de Cognito
‚îÇ       ‚îú‚îÄ‚îÄ main.tf                     # User Pool + Client + Domain
‚îÇ       ‚îú‚îÄ‚îÄ variables.tf                # Variables del m√≥dulo Cognito
‚îÇ       ‚îî‚îÄ‚îÄ outputs.tf                  # Outputs del m√≥dulo Cognito
‚îÇ
‚îú‚îÄ‚îÄ üìÅ environments/                     # Configuraciones por ambiente
‚îÇ   ‚îú‚îÄ‚îÄ üìÅ dev/
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ terraform.tfvars            # Variables para desarrollo
‚îÇ   ‚îî‚îÄ‚îÄ üìÅ prod/
‚îÇ       ‚îî‚îÄ‚îÄ terraform.tfvars            # Variables para producci√≥n
‚îÇ
‚îî‚îÄ‚îÄ üìÅ lambda-code-examples/            # C√≥digo Lambda de ejemplo
    ‚îú‚îÄ‚îÄ subscription-control.js          # Lambda de suscripciones
    ‚îú‚îÄ‚îÄ access-control.js                # Lambda de control de acceso
    ‚îú‚îÄ‚îÄ notification-service.js          # Lambda de notificaciones
    ‚îú‚îÄ‚îÄ package.json                     # Dependencias Node.js
    ‚îî‚îÄ‚îÄ README.md                        # Documentaci√≥n del c√≥digo Lambda


# ============================================
# FLUJO DE DEPENDENCIAS ENTRE M√ìDULOS
# ============================================

‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ   main.tf   ‚îÇ ‚óÑ‚îÄ‚îÄ‚îÄ Orquesta todos los m√≥dulos
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
       ‚îÇ
       ‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
       ‚îÇ              ‚îÇ              ‚îÇ              ‚îÇ              ‚îÇ              ‚îÇ
       ‚ñº              ‚ñº              ‚ñº              ‚ñº              ‚ñº              ‚ñº
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ    VPC     ‚îÇ ‚îÇ  DynamoDB  ‚îÇ ‚îÇ     S3     ‚îÇ ‚îÇ   Lambda   ‚îÇ ‚îÇ    API     ‚îÇ ‚îÇ  Cognito   ‚îÇ
‚îÇ   Module   ‚îÇ ‚îÇ   Module   ‚îÇ ‚îÇ   Module   ‚îÇ ‚îÇ   Module   ‚îÇ ‚îÇ  Gateway   ‚îÇ ‚îÇ   Module   ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
     ‚îÇ               ‚îÇ                              ‚îÇ              ‚îÇ
     ‚îÇ               ‚îÇ                              ‚îÇ              ‚îÇ
     ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¥‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§              ‚îÇ
             ‚îÇ                                      ‚îÇ              ‚îÇ
             ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¥‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
                           Dependencies Flow


# ============================================
# CARACTER√çSTICAS DE LA ARQUITECTURA MODULAR
# ============================================

‚úÖ Separaci√≥n de Responsabilidades
   Cada m√≥dulo tiene una √∫nica responsabilidad bien definida

‚úÖ Reutilizaci√≥n
   Los m√≥dulos pueden ser reutilizados en otros proyectos

‚úÖ Testing Aislado
   Cada m√≥dulo puede ser probado independientemente

‚úÖ Versionado Granular
   Control de versiones por m√≥dulo

‚úÖ Mantenimiento Simplificado
   Cambios localizados sin afectar otros componentes

‚úÖ Documentaci√≥n Clara
   Cada m√≥dulo documenta sus inputs y outputs

‚úÖ Escalabilidad
   F√°cil agregar nuevos m√≥dulos o recursos


# ============================================
# ORDEN DE CREACI√ìN DE RECURSOS
# ============================================

1. üåê VPC Module
   ‚îî‚îÄ‚îÄ VPC, Subnets, IGW, NAT Gateway, Route Tables, VPC Endpoints

2. üìä DynamoDB Module (paralelo con VPC)
   ‚îî‚îÄ‚îÄ Tablas: usuarios, pagos, historial_asistencia

3. ü™£ S3 Module (paralelo con DynamoDB)
   ‚îî‚îÄ‚îÄ Bucket frontend con configuraciones

4. ‚ö° Lambda Module (depende de VPC y DynamoDB)
   ‚îî‚îÄ‚îÄ Security Group ‚Üí IAM Role ‚Üí 3 Funciones Lambda

5. üîå API Gateway Module (depende de Lambda)
   ‚îî‚îÄ‚îÄ HTTP API ‚Üí Integraciones ‚Üí Rutas ‚Üí Permisos

6. üîê Cognito Module (independiente)
   ‚îî‚îÄ‚îÄ User Pool ‚Üí Client ‚Üí Domain


# ============================================
# VENTAJAS DE ESTA ESTRUCTURA
# ============================================

üì¶ MODULARIDAD
   - C√≥digo organizado por funci√≥n
   - F√°cil de entender y mantener
   - Reduce duplicaci√≥n de c√≥digo

üîÑ REUTILIZACI√ìN
   - M√≥dulos pueden usarse en m√∫ltiples proyectos
   - Facilita la estandarizaci√≥n

üß™ TESTING
   - Test unitario por m√≥dulo
   - Test de integraci√≥n en main.tf

üìà ESCALABILIDAD
   - Agregar nuevos m√≥dulos sin afectar existentes
   - Composici√≥n flexible de infraestructura

üë• COLABORACI√ìN
   - Equipos pueden trabajar en m√≥dulos diferentes
   - Menos conflictos en Git

üîí SEGURIDAD
   - Pol√≠ticas por m√≥dulo
   - Aislamiento de recursos

üìä VERSIONADO
   - Control de versiones independiente por m√≥dulo
   - Rollback granular


# ============================================
# COMANDOS COMUNES
# ============================================

# Inicializar (descarga m√≥dulos y providers)
terraform init

# Validar sintaxis y configuraci√≥n
terraform validate

# Formatear c√≥digo
terraform fmt -recursive

# Plan de ejecuci√≥n
terraform plan

# Aplicar cambios
terraform apply

# Aplicar con archivo de variables espec√≠fico
terraform apply -var-file="environments/dev/terraform.tfvars"

# Ver outputs
terraform output

# Destruir infraestructura
terraform destroy

# Actualizar m√≥dulos
terraform get -update

# Ver gr√°fico de dependencias
terraform graph | dot -Tpng > graph.png


# ============================================
# MEJORES PR√ÅCTICAS IMPLEMENTADAS
# ============================================

‚úì M√≥dulos con responsabilidad √∫nica
‚úì Variables con tipos y descripciones
‚úì Outputs documentados
‚úì Tags consistentes
‚úì Nombrado estandarizado
‚úì Ambientes separados (dev/prod)
‚úì Backend remoto configurado
‚úì .gitignore apropiado
‚úì Documentaci√≥n completa
‚úì Pipeline de CI/CD (Jenkins)
‚úì Seguridad por dise√±o
‚úì Escalabilidad considerada


# ============================================
# PR√ìXIMOS PASOS (OPCIONAL)
# ============================================

‚ñ° Implementar m√≥dulo de CloudWatch Alarms
‚ñ° Agregar m√≥dulo de CloudFront para el frontend
‚ñ° Crear m√≥dulo de WAF para seguridad
‚ñ° Implementar m√≥dulo de Route53 para DNS
‚ñ° Agregar m√≥dulo de Secrets Manager
‚ñ° Configurar m√≥dulo de VPC Flow Logs
‚ñ° Implementar m√≥dulo de AWS Backup
‚ñ° Agregar tests automatizados (Terratest)
‚ñ° Configurar m√∫ltiples ambientes (staging)
‚ñ° Implementar GitOps con Terraform Cloud
